# this function is executed once for every new user chatting with altai2
outputmacro: altaia()  # you get altai by default 
$stdtoken = #DO_INTERJECTION_SPLITTING  | #DO_SUBSTITUTE_SYSTEM   | #DO_NUMBER_MERGE | #DO_DATE_MERGE  | #DO_PROPERNAME_MERGE  | #DO_SPELLCHECK  | #DO_PARSE 
$cs_token = $stdtoken

^addtopic(~altaialtai)
$cs_control_main = ~controla
#  $cs_control_post = ~XPOSTPROCESSA  # uncomment to enable talk
$userprompt = ^"%user: >"
$botprompt = ^"Altai: "

table: defaultbot (^name)
^createfact(^name defaultbot defaultbot)
DATA:
altai

topic: ~controla system ()


# on startup, do introduction
u: (%input) 
	gambit(~altaialtai)



topic: ~XPOSTPROCESSA system () # gambits only - not allowed to write to  output - generates speech on windows -- for Linux you'd want to install Festival (or equivalent) and call that instead.

t: (^query(direct_v ? chatoutput ? -1 ? @9  ))  # get the sentences  (why is the object) -- no longer has quotes around it
	loop()
	{
		$$tmp = ^last(@9subject) # note last output which is quoted string
		if (!%server AND %os == windows  AND !$SHUTUP)
		{
			$$tmp = ^"talk \"$$tmp\" "
			popen($$tmp null)
		}
	}
